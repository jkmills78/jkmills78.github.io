<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <meta name="description" content="Kevin's Site : More to come soon...">

    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/style.css?v=">

    <title>Kevin's Site</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="">View on GitHub</a>

          <h1 id="project_title">Kevin's Site</h1>
          <h2 id="project_tagline">More to come soon...</h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <head>
  <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src='http://localhost:4000/assets/js/nav.js' type="text/javascript"></script>
</head>
<!-- Belongs at: /_includes/navigation.html -->

<!-- This finds the current page so it can be highlighted. -->



    
        
    


    


<!-- Then we build the nav bar. -->
<section class="navigation">
	<div id="nav-toggle">
	</div>
  <div class="nav-container">
    <div class="brand">
      <a href="#!">Logo</a>
    </div>
	<nav>
		<ul>
		
			
				
			
			
			
			<li class="current"><a href="/">Home</a></li>
			
		
			
				<!-- We have to declare it 'null' to ensure it doesn't propagate. -->
				
			
			
			
			<li>
				<a href="/group/">Group of Things</a>
				<ul>
					
					<li><a href="/group/si1">Sub-item 1</a></li>
					
					<li><a href="/group/si2">Sub-item 2</a></li>
					
					<li><a href="/group/si3">Sub-item 3</a></li>
					
				</ul>
			</li>
			
		
		</ul>
	</nav>
  </div>
</section>

<div class="code">
  <h1></h1>
  <div class="blog-post spacing">
    <p><br /></p>
<h3>Link to Project</h3>

<p><a href="https://github.com/jkmills78/HelloWorldMVVM" target="_blank">Hello World MVVM Example Source Code</a></p>

<p><br /></p>
<h2>Summary</h2>

<p><strong><em>MVVM</em></strong> is an architectural pattern that is represented by three distinct components, the <strong>Model</strong>, <strong>View</strong> and <strong>ViewModel</strong>. In order to understand these three layers, it is necessary to briefly define each, followed by an explanation of how they work together.</p>

<p><strong>Model</strong> is the layer that drives the business logic. It retrieves and stores information from any data source for consumption by the <strong>ViewModel</strong>.</p>

<p><strong>ViewModel</strong> is the layer that acts as a bridge between the <strong>View</strong> and the <strong>Model*. It may or may not transform the raw data from the **Model</strong> into a presentable form for the <strong>View</strong>. An example transformation would be: a boolean flag from the model to string of ‘True’ or ‘False’ for the <strong>View</strong>.</p>

<p><strong>View</strong> is the layer that represents the interface of the software (i.e. the GUI). Its role is to display the information <em>from</em> the <strong>ViewModel</strong> to the user, and to communicate the changes of the information back to the *ViewModel**.</p>

<p>These three components work together by referencing one another in the following fashion:</p>

<ul>
  <li>The <strong>View</strong> references the <strong>ViewModel</strong>.</li>
  <li>The ViewModel references the <strong>Model</strong>.</li>
</ul>

<p>It is important to note that the <strong>View</strong> and the <strong>ViewModel</strong> are capable of two-way communications known as <strong><em>Data Bindings</em></strong>.</p>

<p>A major component for two-way communication (<strong><em>Data Binding</em></strong>) is the <a href="https://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged(v=vs.110).aspx" target="_blank">INotifyPropertyChanged</a> interface.  By utilizing this mechanism, the <strong>View</strong> can modify the data in the <strong>ViewModel</strong> through user input, and the <strong>ViewModel</strong> can update the <strong>View</strong> with data that may have been updated via processes in the <strong>Model</strong> or with updated data from the repository.</p>

<p><strong><em>MVVM</em></strong> architecture puts a heavy emphasis on the <strong><em>Separation of Concerns</em></strong> for each of these layers. Separating the layers benefits us as:</p>
<ul>
  <li><strong><em>Modularity:</em></strong> Each layer’s internal implementation can be changed or swapped without affecting the others.</li>
  <li><strong><em>Increased testability:</em></strong> Each layer can be <strong>Unit Tested</strong> with mock data, which is not possible if the <strong>ViewModel</strong>’s code is written in the Code-Behind of the <strong>View</strong>.</li>
</ul>

<p><br /></p>
<h2>The Build</h2>

<p>Create a new WPF Application project</p>

<p><br />
<img src="/images/mvvmexample1.png" alt="Create a new WPF Application project" />
Create three new folders in your solution: <strong>Model</strong>, <strong>ViewModel</strong> and <strong>View</strong>, and delete the original <code class="highlighter-rouge">MainWindow.xaml</code>, just to get a fresh start.</p>

<p><br />
<img src="/images/mvvmexample2.png" alt="Create 3 new folders in your solution" />
Create three new items, each corresponding to a separate layer:</p>

<ul>
  <li>Right click the <strong>Model</strong> folder, and add a <strong><em>Class</em></strong> item called <code class="highlighter-rouge">HelloWorldModel.cs</code>.</li>
  <li>Right click the <strong>ViewModel</strong> folder, and add a <strong><em>Class</em></strong> item called <code class="highlighter-rouge">HelloWorldViewModel.cs</code>.</li>
  <li>Right click the <strong>View</strong> folder, and add a <strong><em>Window (WPF)</em></strong> item called <code class="highlighter-rouge">HelloWorldView.xaml</code>.</li>
</ul>

<p><br />
<img src="/images/mvvmexample3.png" alt="Add the three items" />
Alter <code class="highlighter-rouge">App.xaml</code> to point to the new <strong>View</strong></p>

<pre><code class="language-xaml">&lt;Application x:Class="MyMVVMProject.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:MyMVVMProject"
             StartupUri="/View/HelloWorldView.xaml"&gt;
    &lt;Application.Resources&gt;
         
    &lt;/Application.Resources&gt;
&lt;/Application&gt;
</code></pre>

<p><br /></p>
<h3>ViewModel</h3>

<p>Begin with building the <strong>ViewModel</strong> first. The class must implement the <code class="highlighter-rouge">INotifyPropertyChanged</code> interface, declare a <code class="highlighter-rouge">PropertyChangedEventHandler</code> event, and create a method to raise the event (source: <a href="https://docs.microsoft.com/en-us/dotnet/framework/wpf/data/how-to-implement-property-change-notification" target="_blank">MSDN: How to Implement Property Change Notification</a>). Next, declare a field and a corresponding property, making sure to call the <code class="highlighter-rouge">OnPropertyChanged()</code> method in the property’s <code class="highlighter-rouge">set</code> accessor. The constructor in the below example is being used to demonstrate that the <code class="highlighter-rouge">Model</code> provides the data to the <code class="highlighter-rouge">ViewModel</code>.</p>

<div class="language-cs highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Runtime.CompilerServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MyMVVMProject.Model</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MyMVVMProject.ViewModel</span>
<span class="p">{</span>
    <span class="c1">// Implements INotifyPropertyChanged interface to support bindings
</span>    <span class="k">public</span> <span class="k">class</span> <span class="nc">HelloWorldViewModel</span> <span class="p">:</span> <span class="n">INotifyPropertyChanged</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">helloString</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">event</span> <span class="n">PropertyChangedEventHandler</span> <span class="n">PropertyChanged</span><span class="p">;</span>

        <span class="k">public</span> <span class="kt">string</span> <span class="n">HelloString</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">helloString</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="n">helloString</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">OnPropertyChanged</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span>        <span class="c1">/// Raises OnPropertychangedEvent when property changes
</span>        <span class="c1">/// &lt;/summary&gt;
</span>        <span class="c1">/// &lt;param name="name"&gt;String representing the property name&lt;/param&gt;
</span>        <span class="k">protected</span> <span class="k">void</span> <span class="nf">OnPropertyChanged</span><span class="p">([</span><span class="n">CallerMemberName</span><span class="p">]</span> <span class="kt">string</span> <span class="n">name</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">PropertyChanged</span><span class="p">?.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">new</span> <span class="nf">PropertyChangedEventArgs</span><span class="p">(</span><span class="n">name</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="nf">HelloWorldViewModel</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">HelloWorldModel</span> <span class="n">helloWorldModel</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HelloWorldModel</span><span class="p">();</span>
            <span class="n">helloString</span> <span class="p">=</span> <span class="n">helloWorldModel</span><span class="p">.</span><span class="n">ImportantInfo</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p><br /></p>
<h3>Model</h3>

<p>Next, build the <strong>Model</strong>. As stated previously, The <strong>Model</strong> provides data for the <strong>ViewModel</strong> by pulling it from a repository (as well as pushing it back to the repository for saving). This is demonstrated below with the <code class="highlighter-rouge">GetData()</code> method, which will return a simple <code class="highlighter-rouge">List&lt;string&gt;</code>. Business logic is also applied in this layer, and can be seen in the ConcatenateData() method. This method builds the sentence �Hello, world!� from the List<string> that was previously returned from our mock *repository*.</string></p>

<div class="language-cs highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MyMVVMProject.Model</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">HelloWorldModel</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">repositoryData</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">ImportantInfo</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nf">ConcatenateData</span><span class="p">(</span><span class="n">repositoryData</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="nf">HelloWorldModel</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">repositoryData</span> <span class="p">=</span> <span class="nf">GetData</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span>        <span class="c1">/// Simulates data retrieval from a repository
</span>        <span class="c1">/// &lt;/summary&gt;
</span>        <span class="c1">/// &lt;returns&gt;List of strings&lt;/returns&gt;
</span>        <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">GetData</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">repositoryData</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;()</span>
            <span class="p">{</span>
                <span class="s">"Hello"</span><span class="p">,</span>
                <span class="s">"world"</span>
            <span class="p">};</span>
            <span class="k">return</span> <span class="n">repositoryData</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span>        <span class="c1">/// Concatenate the information from the list into a fully formed sentence.
</span>        <span class="c1">/// &lt;/summary&gt;
</span>        <span class="c1">/// &lt;returns&gt;A string&lt;/returns&gt;
</span>        <span class="k">private</span> <span class="kt">string</span> <span class="nf">ConcatenateData</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">dataList</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">importantInfo</span> <span class="p">=</span> <span class="n">dataList</span><span class="p">.</span><span class="nf">ElementAt</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">+</span> <span class="s">", "</span> <span class="p">+</span> <span class="n">dataList</span><span class="p">.</span><span class="nf">ElementAt</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="p">+</span> <span class="s">"!"</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">importantInfo</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p><br /></p>
<h3>View</h3>

<p>Finally, the <strong>View</strong> can be built. There is nothing that needs to be added to the code behind for this example, although this can vary depending on the needs of the application. However, there are a few lines added to the XAML. The <code class="highlighter-rouge">Window</code> needs a reference to the <code class="highlighter-rouge">ViewModel</code> namespace. This is mapped to the XAML namespace <code class="highlighter-rouge">xmlns:vm="clr-namespace:MyMVVMProject.ViewModel"</code>. Next, the Window needs a <code class="highlighter-rouge">DataContext</code>. This is set to <code class="highlighter-rouge">&lt;vm:HelloWorldViewModel/&gt;</code>. Now the label (or control of your choosing) can be added to the window. The key point at this stage is to ensure that you set the <strong>Binding</strong> to the property of the <strong>ViewModel</strong> that you wish to display as the label content. In this case, it is <code class="highlighter-rouge"><span class="p">{</span><span class="err">Binding</span><span class="w"> </span><span class="err">HelloString</span><span class="p">}</span></code>.</p>

<p>It is important to bind to the property, and not the field, as in the latter case the <strong>View</strong> will not receive the notification that the value changed, since the <code class="highlighter-rouge">OnPropertyChanged()</code> method will only raise the <code class="highlighter-rouge">PropertyChangedEvent</code> on the property, and not on the field.</p>

<pre><code class="language-xaml">&lt;Window x:Class="MyMVVMProject.View.HelloWorldView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MyMVVMProject.View"
        xmlns:vm="clr-namespace:MyMVVMProject.ViewModel"
        mc:Ignorable="d"
        Title="HelloWorldView" Height="300" Width="300"&gt;
    &lt;Window.DataContext&gt;
        &lt;vm:HelloWorldViewModel/&gt;
    &lt;/Window.DataContext&gt;
    &lt;Grid&gt;
        &lt;Label x:Name="label" FontSize="30" Content="{Binding HelloString}" HorizontalAlignment="Center" VerticalAlignment="Center"/&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
</code></pre>

  </div>
</div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    
  </body>
</html>
